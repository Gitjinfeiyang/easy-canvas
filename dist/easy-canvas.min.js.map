{"version":3,"file":"easy-canvas.min.js","sources":["../lib/constants.js","../lib/utils.js","../lib/line.js","../lib/flex-box.js","../lib/tree-node.js","../lib/complete-styles.js","../lib/element.js","../lib/view.js","../lib/text.js","../lib/image.js","../lib/event-manager.js","../lib/canvas-render.js","../lib/weapp-adapter.js","../lib/layer.js","../lib/scroll-view.js","../lib/create-element.js","../lib/index.js"],"sourcesContent":["const DISPLAY = {\n  BLOCK: 'block',\n  INLINE_BLOCK: 'inline-block',\n  INLINE: 'inline', // 用户不能设置inline，text默认为inline\n  FLEX: 'flex',\n  NONE: 'none'\n}\n\nconst WIDTH = {\n  AUTO: 'auto',\n  OUTER: '100%'\n}\n\nconst POSITION = {\n  ABSOLUTE: 'absolute',\n  FIXED: 'fixed',\n  RELATIVE: 'relative',\n  STATIC: 'static'\n}\n\nconst TEXT_ALIGN = {\n  LEFT: 'left',\n  RIGHT: 'right',\n  CENTER: 'center'\n}\n\nconst FLEX_DIRECTION = {\n  ROW: 'row',\n  COLUMN: 'column'\n}\n\nconst DEFAULT_STYLES = {\n  display: DISPLAY.BLOCK,\n  fontSize: 14,\n  fontWeight: 400,\n  fontFamily: \"sans-serif\",\n  color: '#000',\n  paddingTop: 0,\n  paddingBottom: 0,\n  paddingLeft: 0,\n  paddingRight: 0,\n  marginTop: 0,\n  marginBottom: 0,\n  marginLeft: 0,\n  marginRight: 0,\n  height: WIDTH.AUTO,\n  borderRadius: 0,\n  lineCap: 'square',\n  flexDirection: FLEX_DIRECTION.ROW,\n  verticalAlign: 'middle',\n  textAlign: 'left',\n  justifyContent: 'flex-start',\n  alignItems: 'flex-start',\n  whiteSpace: 'normal',\n  zIndex: 1,\n  visible: true,\n  position: 'static'\n}\n\nexport default {\n  DISPLAY,\n  WIDTH,\n  POSITION,\n  DEFAULT_STYLES,\n  TEXT_ALIGN,\n  FLEX_DIRECTION\n}\n","export function isExact(num) {\n  return typeof num === \"number\";\n}\n\nexport function isAuto(num) {\n  return num === \"auto\";\n}\n\nexport function isOuter(num) {\n  if (typeof num !== \"string\") return;\n  return num.match(\"%\");\n}\n\nexport function parseOuter(num) {\n  let _n = parseInt(num.replace(\"%\", \"\"));\n  return isNaN(_n) || _n < 0 ? 0 : _n / 100;\n}\n\nexport function walk(element, callback) {\n  let _continue = false; // 是否跳过当前节点以及后面的节点\n  let _next = false; // 是否跳过当前节点数，子元素都不会遍历\n  const _callContinue = () => (_continue = true);\n  const _callNext = () => (_next = true);\n  if (element != null) {\n    const stack = [];\n    let item = null;\n    let children = null;\n    stack.push(element);\n    while (stack.length != 0) {\n      item = stack.pop();\n      callback(item, _callContinue, _callNext);\n      if (!_next) {\n        children = item._getChildren();\n        for (let i = children.length - 1; i >= 0; i--) {\n          if (!_continue) {\n            stack.push(children[i]);\n          } else {\n            // 复位\n            _continue = false;\n          }\n        }\n      } else {\n        // 复位\n        _next = false;\n      }\n    }\n  }\n}\n\nexport function walkParent(element, callback) {\n  if (!element) return;\n  let cur = element;\n  let stop = false;\n  const callbreak = () => {\n    stop = true;\n  };\n  while (cur.parent) {\n    callback(cur.parent, callbreak);\n    if (stop) {\n      break;\n    }\n    cur = cur.parent;\n  }\n}\n\nexport function findRelativeTo(element) {\n  if (element.isInFlow()) return element.parent;\n  if (element.renderStyles.position === \"fixed\") return element.root;\n  let relativeTo = null;\n  walkParent(element, (parent) => {\n    if (parent.renderStyles.position !== \"static\" && !relativeTo) {\n      relativeTo = parent;\n    }\n  });\n  if (!relativeTo) {\n    relativeTo = element.root;\n  }\n  return relativeTo;\n}\n\n//\nconst pow = Math.pow,\n  sqrt = Math.sqrt,\n  sin = Math.sin,\n  cos = Math.cos,\n  PI = Math.PI,\n  c1 = 1.70158,\n  c2 = c1 * 1.525,\n  c3 = c1 + 1,\n  c4 = (2 * PI) / 3,\n  c5 = (2 * PI) / 4.5;\n\nexport function easeInOutElastic(x) {\n  return x === 0\n    ? 0\n    : x === 1\n    ? 1\n    : x < 0.5\n    ? -(pow(2, 20 * x - 10) * sin((20 * x - 11.125) * c5)) / 2\n    : (pow(2, -20 * x + 10) * sin((20 * x - 11.125) * c5)) / 2 + 1;\n}\n\nfunction easeInOutExpo(pos) {\n  if (pos === 0) return 0;\n  if (pos === 1) return 1;\n  if ((pos /= 0.5) < 1) return 0.5 * Math.pow(2, 10 * (pos - 1));\n  return 0.5 * (-Math.pow(2, -10 * --pos) + 2);\n}\n\nexport const isWX = (function () {\n  try {\n    return Boolean(wx.getSystemInfoSync);\n  } catch (err) {\n    return false;\n  }\n})();\n\nexport function isEndNode(el) {\n  return el.parent && !el.next && !el.hasChildren();\n}\n\nexport function breadthFirstSearch(node) {\n  const nodes = [];\n\n  if (node != null) {\n    const queue = [];\n    let item = null;\n    let children = null;\n\n    queue.unshift(node);\n\n    while (queue.length != 0) {\n      item = queue.shift();\n      nodes.push(item._generateRender());\n\n      children = item._getChildren();\n\n      for (let i = 0; i < children.length; i++)\n        queue.push(children[i]._generateRender());\n    }\n  }\n\n  return nodes;\n}\n\nexport function breadthFirstSearchRight(node) {\n  const nodes = [];\n\n  if (node != null) {\n    const queue = [];\n    let item = null;\n    let children = null;\n    queue.unshift(node);\n\n    while (queue.length != 0) {\n      item = queue.shift();\n      nodes.push(item._generateRender());\n\n      children = item._getChildren();\n\n      for (let i = children.length - 1; i >= 0; i--)\n        queue.push(children[i]._generateRender());\n    }\n  }\n\n  return nodes.reverse();\n}\n\nexport function needReflow(style) {\n  return [\n    \"width\",\n    \"height\",\n    \"position\",\n    \"display\",\n    \"padding\",\n    \"paddingTop\",\n    \"paddingLeft\",\n    \"paddingBottom\",\n    \"paddingRight\",\n    \"margin\",\n    \"marginLeft\",\n    \"marginTop\",\n    \"marginBottom\",\n    \"marginRight\",\n    \"borderWidth\",\n    \"flexDirection\",\n    \"justifyContent\",\n    \"alignItems\",\n    \"textAlign\",\n    \"left\",\n    \"top\",\n    \"right\",\n    \"bottom\",\n  ].includes(style);\n}\n\nconst mergeKeys = [\"attrs\", \"styles\", \"on\"];\nexport function mergeOptions(options, mergeOptions) {\n  let mergedOptions = {};\n  mergeKeys.forEach((key) => {\n    if (!options[key]) options[key] = {};\n    if (!mergeOptions[key]) mergeOptions[key] = {};\n    mergedOptions[key] = Object.assign({}, options[key], mergedOptions[key]);\n  });\n  return mergedOptions;\n}\n\nexport function floor(val) {\n  return (0.5 + val) << 0;\n}\n\nexport function qSort3(arr, callback) {\n  //三路快排\n  if (arr.length == 0) {\n    return [];\n  }\n  var left = [];\n  var center = [];\n  var right = [];\n  var pivot = arr[0]; //偷懒，直接取第一个,实际取值情况 参考[快速排序算法的优化思路总结]\n  let val = 0;\n  for (var i = 0; i < arr.length; i++) {\n    val = callback(arr[i], pivot);\n    if (val < 0) {\n      left.push(arr[i]);\n    } else if (val === 0) {\n      center.push(arr[i]);\n    } else {\n      right.push(arr[i]);\n    }\n  }\n  return [...qSort3(left, callback), ...center, ...qSort3(right, callback)];\n}\n\nexport function getThrottle(threshold) {\n  let timer;\n  return function (fn) {\n    if (!timer) {\n      timer = setTimeout(function () {\n        fn();\n        timer = null;\n      }, threshold);\n    }\n  };\n}\n","import { isExact, isAuto } from './utils'\n\nexport default class Line {\n  constructor() {\n    this.width = 0\n    this.height = 0\n    this.contentWidth = 0 // 右边界\n    this.y = 0 // 上\n    this.doorClosed = false // 是否允许加入\n    this.outerWidth = 0\n    this.container = null\n    this.elements = []\n    this.start = null // 起点，行最左边第一个\n    this.end = null // 结束\n    this.offsetX = 0\n    this.id = Math.random()\n  }\n\n  bind(el) {\n    this.container = el.parent\n    this.initHeight(el)\n    this.outerWidth = el.parent && isAuto(el.parent.styles.width) ? Infinity : el.parent.renderStyles.contentWidth\n\n    this.start = el\n    this.add(el)\n  }\n\n  initHeight(el) {\n    this.height = el.parent && el.parent.renderStyles.lineHeight || 0\n  }\n\n  initLayout(el) {\n    this.right = el._getContainerLayout().contentX\n    this.x = el._getContainerLayout().contentX\n    this.y = this.getPreLine(el).y\n  }\n\n  refreshElementPosition(el) {\n    if (this.start === el) {\n      this.initLayout(el)\n    }\n    // 刷新位置，首先以左边计算\n    el.x = this.right + this.offsetX\n    el.y = this.y + this.getOffsetY(el)\n    // + (this.height - el.renderStyles.height) / 2\n    this.right += el.renderStyles.width\n\n  }\n\n  getOffsetY(el) {\n    if (el.renderStyles.verticalAlign === 'bottom') {\n      return (this.height - el.renderStyles.height)\n    } else if (el.renderStyles.verticalAlign === 'middle') {\n      return (this.height - el.renderStyles.height) / 2\n    } else {\n      return 0\n    }\n  }\n\n\n  add(el) {\n    this.elements.push(el)\n    el.line = this\n    this.refreshWidthHeight(el)\n\n    if (!el.next || el.next.renderStyles.display !== 'inline-block') {\n      this.closeLine()\n    }\n  }\n\n  refreshWidthHeight(el) {\n    if (el.renderStyles.height > this.height) {\n      this.height = el.renderStyles.height\n    }\n\n    this.width += el.renderStyles.width\n  }\n\n  canIEnter(el) {\n    if ((el.renderStyles.width + this.width) > this.outerWidth) {\n      this.closeLine()\n      return false\n    } else {\n      return true\n    }\n  }\n\n  closeLine() {\n    // new line\n    this.end = this.elements[this.elements.length - 1]\n    this.refreshXAlign()\n\n  }\n\n  getPreLine(el) {\n    if (el.pre) {\n      if (el.pre.line) {\n        return { y: el.pre.line.height + el.pre.line.y, x: el.pre.line.x }\n      } else {\n        return { y: el._getPreLayout().y + el._getPreLayout().height, x: el._getPreLayout().x }\n      }\n    } else {\n      return { y: el._getContainerLayout().contentY, x: el._getContainerLayout().contentX }\n    }\n  }\n\n  refreshXAlign() {\n    if (this.outerWidth > 5000) return\n    if (!this.end.parent) return\n    let offsetX = this.outerWidth - this.width\n    if (this.end.parent.renderStyles.textAlign === 'center') {\n      offsetX = offsetX / 2\n    } else if (this.end.parent.renderStyles.textAlign === 'left') {\n      offsetX = 0\n    }\n    this.offsetX = offsetX\n  }\n}\n","import Line from './line'\nimport { isExact, isAuto } from './utils'\nimport STYLES from './constants'\n\nconst KEY = {\n  [STYLES.FLEX_DIRECTION.ROW]: {\n    width: 'width',\n    contentWidth: 'contentWidth',\n    x: 'x',\n    y: 'y',\n    contentX: 'contentX',\n    height: 'height',\n    contentHeight: 'contentHeight'\n  },\n  [STYLES.FLEX_DIRECTION.COLUMN]: {\n    width: 'height',\n    contentWidth: 'contentHeight',\n    x: 'y',\n    y: 'x',\n    contentX: 'contentY',\n    height: 'width',\n    contentHeight: 'contentWidth'\n  }\n}\n// 目前flex是基于inline-block的简单实现，只支持row方向width + flex混用\nexport default class FlexBox extends Line {\n  constructor() {\n    super()\n    this.exactValue = 0\n    this.flexTotal = 0\n    this.key = null\n  }\n\n  closeLine() {\n    super.closeLine()\n    this.calcFlex()\n  }\n\n  bind(el) {\n    this.container = el.parent\n    if (el.parent) {\n      this.key = KEY[el.parent.renderStyles.flexDirection]\n    }\n    this.initHeight(el)\n    this.outerWidth = el.parent && isAuto(el.parent.styles[this.key.width]) ? Infinity : el.parent.renderStyles[this.key.contentWidth]\n    this.start = el\n    this.add(el)\n  }\n\n  add(el) {\n    if (isExact(el.styles[this.key.width])) {\n      this.exactValue += el.renderStyles[this.key.width]\n    } else if (isExact(el.styles.flex)) {\n      this.flexTotal += el.renderStyles.flex\n    }\n\n    this.elements.push(el)\n    el.line = this\n    this.refreshWidthHeight(el)\n\n    if (!el.next) {\n      this.closeLine()\n    }\n  }\n\n  initHeight() {\n    this[this.key.height] = 0\n  }\n\n  refreshWidthHeight(el) {\n    if (el.renderStyles[this.key.height] > this[this.key.height]) {\n      this[this.key.height] = el.renderStyles[this.key.height]\n    }\n\n    this[this.key.width] += el.renderStyles[this.key.width]\n  }\n\n  initLayout(el) {\n    this.right = el._getContainerLayout()[this.key.contentX]\n    this[this.key.x] = el._getContainerLayout()[this.key.contentX]\n    this[this.key.y] = this.getPreLine(el)[this.key.y]\n  }\n\n  refreshElementPosition(el) {\n    if (this.start === el) {\n      this.initLayout(el)\n    }\n    // 刷新位置，首先以左边计算\n    el[this.key.x] = this.right + this.offsetX\n    el[this.key.y] = this[this.key.y] + this.getOffsetY(el)\n    // + (this.height - el.renderStyles.height) / 2\n    this.right += el.renderStyles[this.key.width]\n\n  }\n\n  calcFlex() {\n    const { [this.key.contentWidth]: containerWidth } = this.container.renderStyles\n    this.elements.forEach(child => {\n      if (isExact(child.styles.flex)) {\n        child.renderStyles[this.key.width] = (child.styles.flex / this.flexTotal) * (containerWidth - this.exactValue)\n        child._refreshContentWithLayout()\n      }\n    })\n  }\n\n  refreshXAlign() {\n    if (!this.end.parent) return\n    let offsetX = this.outerWidth - this[this.key.width]\n    if (this.end.parent.renderStyles.justifyContent === 'center') {\n      offsetX = offsetX / 2\n    } else if (this.end.parent.renderStyles.justifyContent === 'flex-start') {\n      offsetX = 0\n    }\n    this.offsetX = offsetX\n  }\n\n  getOffsetY(el) {\n    if (el.renderStyles.alignSelf === 'flex-end') {\n      return (this.container.renderStyles[this.key.contentHeight] - el.renderStyles[this.key.height])\n    } else if (el.renderStyles.alignSelf === 'center') {\n      return (this.container.renderStyles[this.key.contentHeight] - el.renderStyles[this.key.height]) / 2\n    } else {\n      return 0\n    }\n  }\n}\n","export default class TreeNode {\n\n  static connectChildren(el) {\n    if (el.hasChildren()) {\n      el.children = el.children.filter(item => item instanceof TreeNode)\n      el._getChildren().map((child, index) => {\n        // 设置parent\n        child._setParent(el)\n        // 设置了上一个兄弟节点\n        child._setSibling(el._getChildren()[index - 1], el._getChildren()[index + 1])\n        TreeNode.connectChildren(child)\n      })\n    } else {\n    }\n  }\n\n  constructor(children) {\n    this.children = children || []\n    this.parent = null\n    this.root = null\n    this.pre = null\n    this.next = null\n  }\n\n\n\n  hasChildren() {\n    return Array.isArray(this.children) && this.children.length ? true : false\n  }\n\n  _getChildren() {\n    return this.hasChildren() ? this.children : []\n  }\n\n  _setParent(element) {\n    this.parent = element\n    this.root = element.root\n  }\n\n  _setSibling(pre, next) {\n    this.pre = pre || null\n    this.next = next || null\n  }\n\n\n  // 添加在最后\n  appendChild(treeNode) {\n    if (!treeNode instanceof TreeNode) throw Error('Unknown treeNode type')\n    const pre = this._getChildren()[this._getChildren().length - 1]\n    pre && pre._setSibling(pre.pre, treeNode)\n    this.children.push(treeNode)\n    treeNode._setParent(this)\n    treeNode._setSibling(pre, null)\n    // return treeNode\n  }\n\n  //\n  prependChild(treeNode) {\n    if (!treeNode instanceof TreeNode) throw Error('Unknown treeNode type')\n    const next = this._getChildren()[0]\n    next && next._setSibling(treeNode, next.next)\n    this.children.unshift(treeNode)\n    treeNode._setParent(this)\n    treeNode._setSibling(null, next)\n    // return treeNode\n  }\n\n  removeChild(treeNode) {\n    if (!treeNode instanceof TreeNode) throw Error('Unknown treeNode type')\n    const index = this._getChildren().indexOf(treeNode)\n    if (index < 0) throw Error('treeNode must be the child of parent')\n    const pre = this._getChildren()[index - 1]\n    const next = this._getChildren()[index + 1]\n    if (pre) {\n      pre._setSibling(pre.pre, next)\n    }\n    if (next) {\n      next._setSibling(pre, next.next)\n    }\n    this.children.splice(index, 1)\n  }\n\n  remove() {\n    if (!this.parent) {\n      throw Error('Can not remove root node')\n    }\n    this.parent.removeChild(this)\n  }\n\n  append(treeNode) {\n    if (!treeNode instanceof TreeNode) throw Error('Unknown treeNode type')\n    if (!this.parent) throw Error('Can not add treeNode to root level!')\n    let children = []\n    treeNode._setParent(this.parent)\n    this.parent.children.forEach((child, index) => {\n      children.push(child)\n      if (child === this) {\n        treeNode._setSibling(child, this.parent.children[index + 1])\n        children.push(treeNode)\n      }\n    })\n    this.parent.children = children\n  }\n\n  prepend(treeNode) {\n    if (!treeNode instanceof TreeNode) throw Error('Unknown treeNode type')\n    if (!this.parent) throw Error('Can not add treeNode to root level!')\n    let children = []\n    treeNode._setParent(this.parent)\n    for (let i = this.parent.children.length - 1; i >= 0; i--) {\n      children.unshift(this.parent.children[i])\n      if (this.parent.children[i] === this) {\n        treeNode._setSibling(this.parent.children[i - 1], this.parent.children[i])\n        children.unshift(treeNode)\n      }\n    }\n    this.parent.children = children\n  }\n\n\n}\n","import { isExact, isAuto, isOuter } from './utils'\nimport STYLES from './constants'\n\n\nexport default function (element) {\n  _completeFlex(element)\n\n  _completeWidth(element)\n\n  _completeBorder(element)\n\n  _completeFont(element)\n\n  _completePaddingMargin(element)\n}\n\n\nfunction _completePaddingMargin(element) {\n  if (element.styles.padding) {\n    if (isExact(element.styles.padding)) {\n      element.styles.paddingLeft = element.styles.padding\n      element.styles.paddingBottom = element.styles.padding\n      element.styles.paddingRight = element.styles.padding\n      element.styles.paddingTop = element.styles.padding\n    } else if (Array.isArray(element.styles.padding)) {\n      // 支持数组[10,20]相当于padding:10px 20px;\n      if (element.styles.padding.length === 2) {\n        element.styles.paddingLeft = element.styles.paddingRight = element.styles.padding[1]\n        element.styles.paddingBottom = element.styles.paddingTop = element.styles.padding[0]\n      } else if (element.styles.padding.length === 4) {\n        element.styles.paddingLeft = element.styles.padding[3]\n        element.styles.paddingBottom = element.styles.padding[2]\n        element.styles.paddingRight = element.styles.padding[1]\n        element.styles.paddingTop = element.styles.padding[0]\n      }\n    }\n  }\n\n  if (isExact(element.styles.margin)) {\n    element.styles.marginLeft = element.styles.margin\n    element.styles.marginBottom = element.styles.margin\n    element.styles.marginRight = element.styles.margin\n    element.styles.marginTop = element.styles.margin\n  } else if (Array.isArray(element.styles.margin)) {\n    // 支持数组[10,20]相当于padding:10px 20px;\n    if (element.styles.margin.length === 2) {\n      element.styles.marginLeft = element.styles.marginRight = element.styles.margin[1]\n      element.styles.marginBottom = element.styles.marginTop = element.styles.margin[0]\n    } else if (element.styles.margin.length === 4) {\n      element.styles.marginLeft = element.styles.margin[3]\n      element.styles.marginBottom = element.styles.margin[2]\n      element.styles.marginRight = element.styles.margin[1]\n      element.styles.marginTop = element.styles.margin[0]\n    }\n  }\n}\n\n/**\n * borderwidth到各个边\n */\nfunction _completeBorder(element) {\n  let { borderWidth, borderLeftWidth, borderRightWidth, borderBottomWidth, borderTopWidth, borderRadius } = element.styles\n  if (!borderWidth) {\n    element.styles.borderWidth = 0\n    borderWidth = 0\n  }\n  if (Array.isArray(borderWidth)) {\n    element.styles.borderTopWidth = borderWidth[0]\n    element.styles.borderRightWidth = borderWidth[1]\n    element.styles.borderBottomWidth = borderWidth[2]\n    element.styles.borderLeftWidth = borderWidth[3]\n  } else {\n    if (!borderLeftWidth) {\n      element.styles.borderLeftWidth = borderWidth\n    }\n    if (!borderRightWidth) {\n      element.styles.borderRightWidth = borderWidth\n    }\n    if (!borderBottomWidth) {\n      element.styles.borderBottomWidth = borderWidth\n    }\n    if (!borderTopWidth) {\n      element.styles.borderTopWidth = borderWidth\n    }\n  }\n  if (borderRadius) {\n    element.styles.overflow = 'hidden'\n  }\n}\n\nfunction _completeWidth(element) {\n  if (!element.styles.width) {\n    if (element.styles.display === STYLES.DISPLAY.INLINE_BLOCK || element.styles.display === STYLES.DISPLAY.INLINE || !element.isInFlow()) {\n      element.styles.width = STYLES.WIDTH.AUTO\n    } else if (element.styles.display === STYLES.DISPLAY.BLOCK || element.styles.display === STYLES.DISPLAY.FLEX) {\n      element.styles.width = STYLES.WIDTH.OUTER\n    } else {\n      element.styles.width = 0\n    }\n  }\n\n  if (isOuter(element.styles.width)) {\n    if (element.parent && isAuto(element.parent.styles.width)) {\n      element.styles.width = STYLES.WIDTH.AUTO\n    }\n  }\n\n  if (isOuter(element.styles.height)) {\n    if (element.parent && isAuto(element.parent.styles.height)) {\n      element.styles.height = STYLES.WIDTH.AUTO\n    }\n  }\n}\n\nfunction _completeFont(element) {\n  if (element.styles.fontSize && !element.styles.lineHeight) {\n    element.styles.lineHeight = element.styles.fontSize * 1.4\n  }\n}\n\nfunction _completeFlex(element) {\n  if (element.parent && element.parent.styles.display === STYLES.DISPLAY.FLEX) {\n    // flex布局内 width 和flex需要有一个\n    if (!element.styles.flex) {\n      if (!isExact(element.styles.height) && !isExact(element.styles.width)) {\n        element.styles.flex = 1\n      }\n    } else {\n      if (element.parent.styles.flexDirection === 'column' && isExact(element.styles.flex)) {\n        element.styles.height = 0\n      } else if (element.parent.styles.flexDirection === 'row' && isExact(element.styles.flex)) {\n        element.styles.width = 0\n      }\n    }\n\n  }\n}\n","import STYLES from './constants'\nimport pxUtil from './px'\nimport { isExact, walk, isOuter, parseOuter, walkParent, isEndNode, isAuto, findRelativeTo, needReflow, floor } from './utils'\nimport Line from './line'\nimport FlexBox from './flex-box'\nimport TreeNode from './tree-node'\nimport completeStyles from './complete-styles'\n\n/**\n * Element类实现盒模型以及定位，不具备绘制\n * 其他类继承实现\n *\n */\n\n\n\n\nexport default class Element extends TreeNode {\n  constructor(options, children) {\n    super(children)\n    this.options = Object.assign({ attrs: {}, styles: {}, on: {} }, options)\n    this.styles = null\n    this.renderStyles = null\n    this.x = 0\n    this.y = 0\n    this.render = null\n    this.container = null\n    this.visible = true\n  }\n\n  init() {\n    this._initStyles()\n    this.initEvent()\n  }\n\n  initEvent() {\n    if (this.options.on) {\n      Object.keys(this.options.on).forEach(eventName => {\n        if (this.getLayer().eventManager.EVENTS.includes(eventName)) {\n          this.getLayer().eventManager.addEventListener(eventName, this.options.on[eventName], this)\n        }\n      })\n    }\n  }\n\n  removeEvent() {\n    this.getLayer().eventManager.removeElement(this)\n  }\n\n  getLayer() {\n    return this.root.layer\n  }\n\n  getRender() {\n    return this.root.layer.render\n  }\n\n  _paint() {\n\n  }\n\n  mount(layer) {\n    layer.mountNode(this)\n  }\n\n  _initStyles() {\n    this.styles = Object.assign({}, this._getDefaultStyles(), this._getParentStyles(this.options.styles), this.options.styles || {})\n\n    this._completeStyles()\n\n    this._initRenderStyles()\n  }\n\n  _initRenderStyles() {\n    const renderStyles = { ...this.styles }\n    const parentWidth = this._getContainerLayout().contentWidth\n    const parentHeight = this._getContainerLayout().contentHeight\n\n    if (isAuto(renderStyles.width)) {\n      renderStyles.paddingWidth = 0\n    } else if (isOuter(renderStyles.width)) {\n      renderStyles.paddingWidth = parseOuter(renderStyles.width) * parentWidth - renderStyles.marginLeft - renderStyles.marginRight\n    } else {\n      renderStyles.paddingWidth = renderStyles.width\n    }\n\n    if (isAuto(renderStyles.height)) {\n      renderStyles.paddingHeight = 0\n    } else if (isOuter(renderStyles.height)) {\n      renderStyles.paddingHeight = parseOuter(renderStyles.height) * parentHeight - renderStyles.marginTop - renderStyles.marginBottom\n    } else {\n      renderStyles.paddingHeight = renderStyles.height\n    }\n\n    if (!renderStyles.paddingWidth) renderStyles.paddingWidth = 0\n    if (!renderStyles.paddingHeight) renderStyles.paddingHeight = 0\n\n    // 初始化contentWidth\n    renderStyles.contentWidth = renderStyles.paddingWidth - renderStyles.paddingLeft - renderStyles.paddingRight\n    renderStyles.contentHeight = renderStyles.paddingHeight - renderStyles.paddingTop - renderStyles.paddingBottom\n\n    renderStyles.width = renderStyles.paddingWidth + renderStyles.marginLeft + renderStyles.marginRight + this._getTotalBorderWidth(renderStyles)\n    renderStyles.height = renderStyles.paddingHeight + renderStyles.marginTop + renderStyles.marginBottom + this._getTotalBorderHeight(renderStyles)\n\n    this.renderStyles = renderStyles\n\n    if (this._InFlexBox()) {\n      this._bindFlexBox()\n    } else if (!this.isInFlow()) {\n      this.relativeTo = findRelativeTo(this)\n    }\n\n\n  }\n\n  /**\n   * 需要继承的styles放在这里\n   */\n  _getParentStyles(curStyles) {\n    let { textAlign, lineHeight, fontSize, color, fontFamily, alignItems, visible = true } = this.parent && this.parent.renderStyles || {}\n    let extendStyles = {}\n    if (textAlign) extendStyles.textAlign = textAlign\n    if (fontSize) extendStyles.fontSize = fontSize\n    if (color) extendStyles.color = color\n    if (fontFamily) extendStyles.fontFamily = fontFamily\n    if (alignItems && !curStyles.alignSelf) extendStyles.alignSelf = alignItems\n    extendStyles.visible = visible\n    return extendStyles\n  }\n\n  _completeStyles() {\n    completeStyles(this)\n  }\n\n  _getDefaultStyles() {\n    return STYLES.DEFAULT_STYLES\n  }\n\n  // 获取文档流中的子节点\n  _getChildrenInFlow() {\n    return this._getChildren().filter(item => item.isInFlow())\n  }\n\n  // 是否在文档流中\n  isInFlow() {\n    const { position, display } = this.styles\n    return position !== STYLES.POSITION.ABSOLUTE && position !== STYLES.POSITION.FIXED\n  }\n\n  isVisible() {\n    return this.renderStyles.visible && this.visible\n  }\n\n  _generateRender() {\n    return this\n  }\n\n  getCtx() {\n    return this.root.layer.ctx\n  }\n\n  /**\n   * 实现文档流 需要知道上一个兄弟节点\n   */\n  _reflow() {\n\n\n  }\n\n  _initWidthHeight() {\n    const { width, height, display, flex, marginLeft, marginRight, marginTop, marginBottom } = this.styles\n    if (isAuto(width) || isAuto(height)) {\n      // 这一步需要遍历，判断一下\n      const layout = this._measureLayout()\n      // 初始化宽度高度\n      if (isAuto(width)) {\n        this.renderStyles.contentWidth = floor(layout.width)\n      }\n\n      if (isAuto(height)) {\n        // 不填就是auto\n        this.renderStyles.contentHeight = floor(layout.height)\n      }\n    }\n\n    this._refreshLayoutWithContent()\n\n    if (this._InFlexBox()) {\n      this.line.refreshWidthHeight(this)\n    } else if (display === STYLES.DISPLAY.INLINE_BLOCK) {\n      // 如果是inline-block  这里仅计算高度\n      this._bindLine()\n    }\n  }\n\n  _initPosition() {\n    let { contentX } = this._getContainerLayout()\n    const { paddingLeft, paddingTop, borderLeftWidth, borderTopWidth, marginLeft, marginTop } = this.renderStyles\n    // 初始化ctx位置\n    if (!this.isInFlow()) {\n      // 不在文档流中\n      let { contentX, contentY, contentWidth, contentHeight } = this._getContainerLayout(this.relativeTo)\n      let { top, bottom, right, left, width, height } = this.renderStyles\n      if (isOuter(top)) top = parseOuter(top) * contentHeight\n      if (isOuter(bottom)) bottom = parseOuter(bottom) * contentHeight\n      if (isOuter(left)) left = parseOuter(left) * contentWidth\n      if (isOuter(right)) right = parseOuter(right) * contentWidth\n      if (isExact(top)) {\n        this.y = contentY + top\n      } else if (isExact(bottom)) {\n        this.y = contentY + contentHeight - bottom - height\n      }\n\n      if (isExact(left)) {\n        this.x = contentX + left\n      } else if (isExact(right)) {\n        this.x = contentX + contentWidth - right - width\n      }\n    } else if (this._InFlexBox()) {\n      this.line.refreshElementPosition(this)\n    } else if (this.renderStyles.display === STYLES.DISPLAY.INLINE_BLOCK) {\n      // inline-block到line里计算\n      // this._bindLine()\n      this.line.refreshElementPosition(this)\n    } else {\n      this.x = contentX\n      this.y = this._getPreLayout().y + this._getPreLayout().height\n    }\n    this.x = floor(this.x)\n    this.y = floor(this.y)\n    this.contentX = this.x + paddingLeft + borderLeftWidth + marginLeft\n    this.contentY = this.y + paddingTop + borderTopWidth + marginTop\n  }\n\n  _InFlexBox() {\n    if (!this.isInFlow()) return false\n    if (!this.parent) return false\n    if (this.parent && this.parent.renderStyles.display === STYLES.DISPLAY.FLEX) return true\n  }\n\n\n  // 父元素根据子元素撑开content后，再计算width\n  _refreshLayoutWithContent() {\n    this.renderStyles.height = floor(this.renderStyles.contentHeight + this.renderStyles.paddingTop + this.renderStyles.paddingBottom + this.renderStyles.marginTop + this.renderStyles.marginBottom + this._getTotalBorderHeight())\n    this.renderStyles.width = floor(this.renderStyles.contentWidth + this.renderStyles.paddingLeft + this.renderStyles.paddingRight + this.renderStyles.marginLeft + this.renderStyles.marginRight + this._getTotalBorderWidth())\n    this.renderStyles.paddingWidth = floor(this.renderStyles.contentWidth + this.renderStyles.paddingLeft + this.renderStyles.paddingRight)\n    this.renderStyles.paddingHeight = floor(this.renderStyles.contentHeight + this.renderStyles.paddingTop + this.renderStyles.paddingBottom)\n  }\n\n  // 父元素根据子元素撑开content后，再计算width\n  _refreshContentWithLayout() {\n    this.renderStyles.contentHeight = this.renderStyles.height - this.renderStyles.paddingTop - this.renderStyles.paddingBottom - this.renderStyles.marginTop - this.renderStyles.marginBottom - this._getTotalBorderHeight()\n    this.renderStyles.contentWidth = this.renderStyles.width - this.renderStyles.paddingLeft - this.renderStyles.paddingRight - this.renderStyles.marginLeft - this.renderStyles.marginRight - this._getTotalBorderWidth()\n    this.renderStyles.paddingWidth = floor(this.renderStyles.contentWidth + this.renderStyles.paddingLeft + this.renderStyles.paddingRight)\n    this.renderStyles.paddingHeight = floor(this.renderStyles.contentHeight + this.renderStyles.paddingTop + this.renderStyles.paddingBottom)\n  }\n\n  _getTotalBorderWidth(renderStyles = this.renderStyles) {\n    return renderStyles.borderLeftWidth + renderStyles.borderRightWidth\n  }\n\n  _getTotalBorderHeight(renderStyles = this.renderStyles) {\n    return renderStyles.borderTopWidth + renderStyles.borderBottomWidth\n  }\n\n  _bindLine() {\n    if (this.pre && this.pre.line && this.pre.line.canIEnter(this)) {\n      this.pre.line.add(this)\n    } else {\n      // 新行\n      new Line().bind(this)\n    }\n  }\n\n  _bindFlexBox() {\n    if (this.pre && this.pre.line) {\n      this.pre.line.add(this)\n    } else {\n      // 新行\n      new FlexBox().bind(this)\n    }\n  }\n\n  _getContainerLayout(container = this.parent) {\n    if (!container) {\n      // root\n      if (!this.container) {\n        debugger\n      }\n      container = {\n        renderStyles: {\n          width: this.container.width,\n          height: this.container.height,\n          paddingTop: 0,\n          paddingBottom: 0,\n          paddingLeft: 0,\n          paddingRight: 0,\n          marginLeft: 0,\n          marginRight: 0,\n          marginTop: 0,\n          marginBottom: 0,\n          contentWidth: this.container.width,\n          contentHeight: this.container.height\n        },\n        x: 0,\n        y: 0,\n        contentX: 0,\n        contentY: 0\n      }\n    }\n    return {\n      width: container.renderStyles.width,\n      height: container.renderStyles.height,\n      x: container.x,\n      y: container.y,\n      paddingTop: container.renderStyles.paddingTop,\n      paddingBottom: container.renderStyles.paddingBottom,\n      paddingLeft: container.renderStyles.paddingLeft,\n      paddingRight: container.renderStyles.paddingRight,\n      marginLeft: container.renderStyles.marginLeft,\n      marginRight: container.renderStyles.marginRight,\n      marginTop: container.renderStyles.marginTop,\n      marginBottom: container.renderStyles.marginBottom,\n      contentX: container.contentX,\n      contentY: container.contentY,\n      contentWidth: container.renderStyles.contentWidth,\n      contentHeight: container.renderStyles.contentHeight\n    }\n  }\n\n  // 这里前一个节点必须在文档流中\n  _getPreLayout() {\n    let cur = this.pre\n    while (cur && !cur.isInFlow()) {\n      cur = cur.pre\n    }\n    // 如果没有前一个或者前面的都不在文档流中，获取容器的\n    if (cur) {\n      return {\n        width: cur.renderStyles.width,\n        height: cur.renderStyles.height,\n        x: cur.x,\n        y: cur.y\n      }\n    } else {\n      return {\n        width: 0,\n        height: 0,\n        x: this._getContainerLayout().contentX,\n        y: this._getContainerLayout().contentY\n      }\n    }\n  }\n\n  // 计算自身的高度\n  _measureLayout() {\n    let width = 0 // 需要考虑原本的宽度\n    let height = 0\n    this._getChildrenInFlow().forEach(child => {\n      if (child.line) {\n        if (child.line.start === child) {\n          if (child.line.width > width) {\n            width = child.line.width\n          }\n          height += child.line.height\n        }\n      } else if (child.renderStyles.width > width) {\n        width = child.renderStyles.width\n        height += child.renderStyles.height\n      } else {\n        height += child.renderStyles.height\n      }\n    })\n\n    return { width, height }\n  }\n\n  // 获取元素，只会找该元素子级\n  getElementBy(key, value) {\n    let match = []\n    walk(this, (element) => {\n      if (element.options.attrs[key] === value) {\n        match.push(element)\n      }\n    })\n    return match\n  }\n\n  // 添加在最后\n  appendChild(element) {\n    super.appendChild(element)\n    this.getLayer().onElementAdd(element)\n    return element\n  }\n\n  //\n  prependChild(element) {\n    super.prependChild(element)\n    this.getLayer().onElementAdd(element)\n    return element\n  }\n\n  removeChild(element) {\n    super.removeChild(element)\n    this.getLayer().onElementRemove(element)\n  }\n\n  append(element) {\n    super.append(element)\n    this.getLayer().onElementAdd(element)\n  }\n\n  prepend(element) {\n    super.prepend(element)\n    this.getLayer().onElementAdd(element)\n  }\n\n  setStyles(styles) {\n    let _needReflow = false\n    Object.keys(styles).forEach(key => {\n      if (needReflow(key)) {\n        _needReflow = true\n      } else {\n        this.renderStyles[key] = styles[key]\n      }\n    })\n    if (_needReflow) {\n      Object.keys(styles).forEach(key => {\n        this.options.styles[key] = styles[key]\n      })\n      this.getLayer().reflowElement(this, this)\n      // console.warn('实验性功能')\n    } else {\n      this.getRender().requestRepaint()\n    }\n  }\n\n}\n","import Element from './element'\nimport STYLES from './constants'\nimport { isExact } from './utils'\n\nexport default class View extends Element {\n\n  constructor(options, children) {\n    super(options, children)\n    this.type = 'view'\n  }\n\n  _getDefaultStyles() {\n    return {\n      ...STYLES.DEFAULT_STYLES,\n      display: STYLES.DISPLAY.BLOCK\n    }\n  }\n\n  _paint() {\n    if(this.options.render){\n      this.options.render(this.getRender().getCtx(),this.getRender().getCanvas(),this)\n    }else{\n      this.getRender()._drawBackground(this)\n      this.getRender()._drawBox(this)\n    }\n  }\n\n\n}\n","import Element from './element'\nimport STYLES from './constants'\nimport { isExact, isAuto } from './utils'\n\nexport default class Text extends Element {\n  constructor(options, children) {\n    super(options, children)\n    this._layout = null // layout用来保存计算的自身高度\n    this._lines = []\n    this.children += ''\n    this.type = 'text'\n    this.debugColor = 'blue'\n  }\n\n  _paint() {\n    this.getRender()._drawBackground(this)\n    this.getRender()._drawText(this)\n    this.getRender()._drawBox(this)\n  }\n\n  _getDefaultStyles() {\n    return {\n      ...STYLES.DEFAULT_STYLES,\n      display: STYLES.DISPLAY.INLINE_BLOCK,\n      width: STYLES.WIDTH.AUTO,\n      textAlign: 'left',\n    }\n  }\n\n  _measureLayout() {\n    this._layout = this.getRender().measureText(this, this.children)\n    this._layout.height = this.renderStyles.lineHeight\n    this._calcLine()\n    return this._layout\n  }\n\n  _getFont() {\n    const { fontSize, fontWeight, fontFamily } = this.renderStyles\n    return `${fontWeight} ${fontSize}px ${fontFamily}`\n  }\n\n  _calcLine() {\n    if (!this.parent || !this.children) return\n    const { width: textWidth, height: textHeight } = this._layout\n    let { contentWidth: parentContentWidth } = this.parent.renderStyles\n    const { width: parentWidth } = this.parent.styles\n    if (!isAuto(this.styles.width)) parentContentWidth = this.renderStyles.width\n    // 如果一行宽度够，或者父级宽度是auto\n    if ((isExact(parentContentWidth) && parentContentWidth >= textWidth) || parentWidth === STYLES.WIDTH.AUTO) {\n      this._lines = [{\n        text: this.children,\n        layout: this._layout\n      }]\n    } else {\n      this._lines = []\n      let lineIndex = 1\n      let lineText = ''\n      let _layout = null\n      let lastLayout = null\n      for (let i = 0; i < this.children.length; i++) {\n        _layout = this.getRender().measureText(this, lineText + this.children[i])\n        if (_layout.width > parentContentWidth) {\n          if (lineIndex >= this.renderStyles.maxLine) {\n            // 最大行数限制 以及maxline省略号实现\n            lineText = lineText.substring(0, lineText.length - 2) + '...'\n            break\n          }\n          // 超出了\n          this._lines.push({\n            text: lineText,\n            layout: lastLayout || _layout\n          })\n          lineText = ''\n          lineIndex += 1\n\n        }\n\n        lineText += this.children[i]\n\n        lastLayout = _layout\n      }\n      this._layout.width = parentContentWidth\n      this._lines.push({\n        text: lineText,\n        layout: this.getRender().measureText(this, lineText)\n      })\n      // 根据lineheihgt更新height\n      this._layout.height = this._lines.length * this.renderStyles.lineHeight\n    }\n  }\n\n  getInnerText() {\n    return this.children\n  }\n\n  setInnerText(val) {\n    if (val === undefined) return\n    if (val === this.children) return\n    this.children = val\n    this.getLayer().reflowElement(this)\n  }\n}\n","import View from \"./view\";\nimport STYLES from \"./constants\";\nimport { isExact, isAuto, isWX } from \"./utils\";\nimport { getImage } from \"./weapp-adapter\";\n\nexport default class $Image extends View {\n  constructor(options, children) {\n    super(options, children);\n    this.type = \"image\";\n    this._imageInfo = {\n      width: 0,\n      height: 0,\n      sx: 0,\n      sy: 0,\n      swidth: 0,\n      sheight: 0,\n      dx: 0,\n      dy: 0,\n      dwidth: 0,\n      dheight: 0,\n    };\n    this.debugColor = \"blue\";\n    this._image = null;\n    this._layout = null;\n  }\n\n  init() {\n    super.init();\n    if (this.options && this.options.attrs && this.options.attrs.timeout) {\n      setTimeout(() => {\n        this._loadImage();\n      }, this.options.attrs.timeout || 0);\n    } else {\n      this._loadImage();\n    }\n  }\n\n  _paint() {\n    this.getRender()._drawBackground(this);\n    this.getRender()._drawImage(this);\n    this.getRender()._drawBox(this);\n  }\n\n  _loadImage() {\n    const { mode } = this.options.attrs;\n\n    return new Promise((resolve, reject) => {\n      this.getRender()\n        .getImageInstance(this.options.attrs.src)\n        .then(({ info, image }) => {\n          this._imageInfo = { ...info };\n          this._image = image;\n          resolve();\n\n          this._layoutImage();\n\n          if (this.isVisible()) {\n            // if (mode === 'aspectFill' || mode === 'aspectFit') {\n            //   // this.getLayer().onElementChange(this)\n            //   this.getLayer().repaint(this)\n            // } else {\n            // // 重新布局绘制\n            this.getLayer().reflowElement(this);\n            // }\n          }\n\n          // call load callback\n          if (this.options.on && this.options.on.load) {\n            this.options.on.load(this);\n          }\n        })\n        .catch((err) => {\n          // call error callback\n          if (this.options.on && this.options.on.error) {\n            this.options.on.error(err);\n          }\n        });\n    });\n  }\n\n  // 计算图片布局\n  _layoutImage() {\n    const { contentWidth, contentHeight } = this.renderStyles;\n    const { mode } = this.options.attrs;\n    const { width, height } = this.styles;\n    const { width: imageW, height: imageH } = this._imageInfo;\n    // 根据用户设置判断图片宽高，目前支持widthfix、heightfix、平铺\n    let w = contentWidth;\n    let h = contentHeight;\n    if (!isAuto(width) && isAuto(height)) {\n      // width fix\n      w = contentWidth;\n      h = getHeightByWidth(w, imageW, imageH);\n    } else if (!isAuto(height) && isAuto(width)) {\n      // height fix\n      h = contentHeight;\n      w = getWidthByHeight(h, imageW, imageH);\n    } else if (isAuto(width) && isAuto(height)) {\n      // auto\n      w = imageW;\n      h = imageH;\n    } else if (mode === \"aspectFill\") {\n      // 填充\n      if (w / h > imageW / imageH) {\n        this._imageInfo.swidth = imageW;\n        this._imageInfo.sheight = getHeightByWidth(imageW, w, h);\n        this._imageInfo.sx = 0;\n        this._imageInfo.sy = (imageH - this._imageInfo.sheight) / 2;\n      } else {\n        this._imageInfo.sheight = imageH;\n        this._imageInfo.swidth = getWidthByHeight(\n          imageH,\n          contentWidth,\n          contentHeight\n        );\n        this._imageInfo.sy = 0;\n        this._imageInfo.sx = (imageW - this._imageInfo.swidth) / 2;\n      }\n    } else if (mode === \"aspectFit\") {\n      if (w / h > imageW / imageH) {\n        this._imageInfo.dwidth = getWidthByHeight(\n          contentHeight,\n          imageW,\n          imageH\n        );\n        this._imageInfo.dheight = contentHeight;\n        this._imageInfo.dy = this.contentY;\n        this._imageInfo.dx =\n          (contentWidth - this._imageInfo.dwidth) / 2 + this.contentX;\n      } else {\n        this._imageInfo.dheight = getHeightByWidth(\n          contentWidth,\n          imageW,\n          imageH\n        );\n        this._imageInfo.dwidth = contentWidth;\n        this._imageInfo.dx = this.contentX;\n        this._imageInfo.dy =\n          (contentHeight - this._imageInfo.dheight) / 2 + this.contentY;\n      }\n    } else {\n      w = contentWidth;\n      h = contentHeight;\n    }\n    this._layout = { width: w, height: h };\n  }\n\n  _measureLayout() {\n    if (this._layout) {\n      return this._layout;\n    } else {\n      return {\n        width: this.renderStyles.width,\n        height: this.renderStyles.height,\n      };\n    }\n  }\n}\n\nfunction getWidthByHeight(height, originWidth, originHeight) {\n  return (height / originHeight) * originWidth;\n}\n\nfunction getHeightByWidth(width, originWidth, originHeight) {\n  return (width / originWidth) * originHeight;\n}\n","import TreeNode from \"./tree-node\";\nimport { walkParent, walk } from \"./utils\";\nconst events = [\"click\", \"touchstart\", \"touchmove\", \"touchend\", \"mousewheel\"];\n/**\n * 事件管理器\n * 将dom事件分发到canvas中的节点\n * 支持捕获与冒泡\n */\nexport default class EventManager {\n  constructor({ simulateClick = true }) {\n    this.EVENTS = events;\n    this.clear();\n    this.touchStartEvent = null;\n    this.simulateClick = simulateClick; // 是否模拟移动端点击事件\n  }\n\n  clear() {\n    events.forEach((eventName) => {\n      this[`${eventName}Tree`] = new TreeNode();\n      this[`${eventName}List`] = [];\n    });\n  }\n\n  click(x, y) {\n    let event = new Event({ x, y, type: \"click\" });\n    this._emit(event);\n  }\n\n  touchstart(x, y) {\n    let event = new Event({ x, y, type: \"touchstart\" });\n    this.touchStartEvent = event;\n    this._emit(event);\n  }\n\n  touchmove(x, y) {\n    let event = new Event({ x, y, type: \"touchmove\" });\n    this._emit(event);\n  }\n\n  touchend(x, y) {\n    let event = new Event({ x, y, type: \"touchend\" });\n    this._emit(event);\n    this.checkClick(event);\n  }\n\n  mousewheel(x, y, deltaX, deltaY) {\n    let event = new Event({ x, y, deltaX, deltaY, type: \"mousewheel\" });\n    this._emit(event);\n  }\n\n  _emit(e) {\n    let tree = this[`${e.type}Tree`];\n    if (!tree) return;\n\n    /**\n     * 遍历树，检查是否回调\n     * 如果父级没有被触发，则子级也不需要检查，跳到下个同级节点\n     * 执行capture回调，将on回调添加到stack\n     */\n    let callbackList = [];\n    let curArr = tree._getChildren();\n    while (curArr.length) {\n      walkArray(curArr, (node, callBreak, isEnd) => {\n        if (\n          node.element.isVisible() &&\n          this.isPointInElement(e.relativeX, e.relativeY, node.element)\n        ) {\n          node.runCapture(e);\n          callbackList.unshift(node);\n          // 同级后面节点不需要执行了\n          callBreak();\n          curArr = node._getChildren();\n        } else if (isEnd) {\n          // 到最后一个还是没监测到，结束\n          curArr = [];\n        }\n      });\n    }\n\n    /**\n     * 执行on回调，从子到父\n     */\n    for (let i = 0; i < callbackList.length; i++) {\n      if (!e.currentTarget) e.currentTarget = callbackList[i].element;\n      callbackList[i].runCallback(e);\n      if (e.cancelBubble) break;\n    }\n  }\n\n  // 待优化\n  isPointInElement(x, y, element) {\n    let a1 = x >= element.x;\n    let a2 = y >= element.y;\n    let a3 = x <= element.x + element.renderStyles.width;\n    let a4 = y <= element.y + element.renderStyles.height;\n    if (a1 && a2 && a3 && a4) {\n      return true;\n    }\n    return false;\n  }\n\n  removeElement(element) {\n    events.forEach((eventName) => {\n      this[`${eventName}List`] = this[`${eventName}List`].filter((item) => {\n        if (item.element === element) {\n          item.remove();\n        }\n        return item.element !== element;\n      });\n    });\n  }\n\n  addEventListener(type, callback, element, isCapture) {\n    const tree = this[`${type}Tree`];\n    const list = this[`${type}List`];\n    if (!tree) {\n      console.error(\"Unknown event name [\" + type + \"]\");\n    }\n    this.addCallback(callback, element, tree, list, isCapture);\n  }\n\n  /**\n   * 不在文档流中，提到relativeTo同级\n   * 根据element树的层级关系构建一个监听回调树模型，提高性能\n   * 有新的监听时，查找应该挂载在哪个节点\n   * 如果节点已经存在，复用原节点\n   * @param {Function} callback\n   * @param {Element} element\n   * @param {Callback} tree\n   * @param {Array<Callback>} list\n   * @param {Boolean} isCapture\n   */\n  addCallback(callback, element, tree, list, isCapture) {\n    let parent = null;\n    let node = null;\n    // 寻找应该挂载的父节点\n    let target = element;\n    for (let i = list.length - 1; i >= 0; i--) {\n      // 寻找已存在节点\n      if (element === list[i].element) {\n        // 当前\n        parent = list[i - 1];\n        node = list[i];\n        break;\n      }\n      // 寻找应该挂载的父节点 通过对比当前父级最近的父级\n      if (!element.isInFlow()) {\n        target = element.relativeTo.parent;\n        if (!target) {\n          break;\n        }\n      }\n      walkParent(target, (p, callBreak) => {\n        if (p === list[i].element) {\n          parent = list[i];\n          callBreak();\n        }\n      });\n      if (parent) {\n        break;\n      }\n    }\n\n    // 如果不存在同样的元素节点\n    if (!node) {\n      node = new Callback(element, callback);\n    }\n\n    // 添加回调方法\n    if (isCapture) {\n      node.addCapture(callback);\n    } else {\n      node.addCallback(callback);\n    }\n\n    // 挂载节点\n    if (parent) {\n      // 用prepend是因为后来的层级上高于前面的，但是只有在absolute的元素才能感受到\n      parent.prependChild(node);\n    } else {\n      tree.prependChild(node);\n    }\n\n    // 缓存到list\n    list.push(node);\n  }\n\n  // 这里利用touchstart和touchend实现了移动端click事件\n  checkClick(event) {\n    if (this.touchStartEvent && this.simulateClick) {\n      // 判断两点距离\n      let { x: startx, y: starty } = this.touchStartEvent;\n      let { x: endx, y: endy } = event;\n      let distance =\n        endy * endy + endx * endx - (starty * starty + startx * startx);\n      if (distance < 5 && distance > -5) {\n        this.click(endx, endy);\n      }\n    }\n  }\n}\n\nclass Event {\n  constructor({ x, y, type, deltaX, deltaY }) {\n    this.x = x;\n    this.y = y;\n    this.relativeX = x; // scroll到每一层scrollview会不断变化\n    this.relativeY = y;\n    this.type = type;\n    this.cancelBubble = false;\n    this.currentTarget = null; // 第一个element\n\n    if (type === \"mousewheel\") {\n      this.deltaX = deltaX;\n      this.deltaY = deltaY;\n    }\n  }\n\n  // 阻止冒泡\n  stopPropagation() {\n    this.cancelBubble = true;\n  }\n}\n\nclass Callback extends TreeNode {\n  constructor(element) {\n    super();\n    this.element = element;\n    this.callbackList = [];\n    this.captureList = [];\n  }\n\n  addCallback(callback) {\n    this.callbackList.push(callback);\n  }\n\n  addCapture(callback) {\n    this.captureList.push(callback);\n  }\n\n  runCallback(params) {\n    this.callbackList.forEach((item) => item.call(this.element, params));\n  }\n\n  runCapture(params) {\n    this.captureList.forEach((item) => item.call(this.element, params));\n  }\n}\n\nfunction walkArray(arr, callback) {\n  let _break = false;\n  const callBreak = () => (_break = true);\n  for (let i = 0; i < arr.length; i++) {\n    callback(arr[i], callBreak, i === arr.length - 1 ? true : false);\n    if (_break) {\n      break;\n    }\n  }\n}\n","import { isExact, walk, isEndNode, isWX, getThrottle, floor } from \"./utils\";\nimport STYLES from \"./constants\";\nimport { getImage } from \"./weapp-adapter\";\n\nconst angle = Math.PI / 2;\n\n/**\n * 封装图形api\n */\nexport default class CanvasRender {\n  constructor(layer) {\n    this.layer = layer;\n    this.imageBus = {};\n    this.isAnimate = false;\n    this.lastPaintTime = 0;\n    this.lastFrameComplete = false;\n    this.throttle = getThrottle(16);\n  }\n\n  isDebug() {\n    return this.getLayer().options && this.getLayer().options.debug;\n  }\n\n  getCtx() {\n    return this.layer.ctx;\n  }\n\n  getLayer() {\n    return this.layer;\n  }\n\n  _restore(callback) {\n    this.getCtx().save();\n    callback();\n    this.getCtx().restore();\n  }\n\n  _path(callback) {\n    this.getCtx().beginPath();\n    callback();\n    this.getCtx().closePath();\n  }\n\n  paint(element) {\n    this.getCtx().save();\n\n    element._paint(this.lastPaintTime);\n\n    this.afterPaint(element);\n  }\n\n  afterPaint(element) {\n    // 这里通过this.ctx栈实现了overflow\n    // 第一步判断没有子元素，绘制完成即restore 有子元素需要子元素全部绘制完毕再restore\n    if (!element.hasChildren() || element.type === \"text\") {\n      this.getCtx().restore();\n    }\n\n    // 如果到了层级的最后一个 释放父级的stack\n    this._helpParentRestoreCtx(element);\n  }\n\n  _helpParentRestoreCtx(element) {\n    if (\n      (element.isVisible() && !isEndNode(element)) ||\n      (!element.isVisible() && element.next)\n    )\n      return;\n    this.getCtx().restore();\n    let cur = element.parent;\n    while (cur && !cur.next) {\n      // 如果父级也是同级最后一个，再闭合上一个\n      this.getCtx().restore();\n      cur = cur.parent;\n    }\n  }\n\n  topBorder({ x, y, borderRadius, w, h }) {\n    // 左上角开始\n    this.getCtx().moveTo(x, y + borderRadius);\n    borderRadius &&\n      this.getCtx().arc(\n        x + borderRadius,\n        y + borderRadius,\n        borderRadius,\n        2 * angle,\n        3 * angle\n      );\n    this.getCtx().lineTo(x + w - borderRadius, y);\n  }\n\n  rightBorder({ x, y, borderRadius, w, h }) {\n    // 右上角\n    // this.getCtx().moveTo(x + w - borderRadius, y)\n    borderRadius &&\n      this.getCtx().arc(\n        x + w - borderRadius,\n        y + borderRadius,\n        borderRadius,\n        3 * angle,\n        4 * angle\n      );\n    this.getCtx().lineTo(x + w, y + h - borderRadius);\n  }\n\n  bottomBorder({ x, y, borderRadius, w, h }) {\n    // 右下角\n    // this.getCtx().moveTo(x + w, y + h - borderRadius)\n    borderRadius &&\n      this.getCtx().arc(\n        x + w - borderRadius,\n        y + h - borderRadius,\n        borderRadius,\n        0,\n        angle\n      );\n    this.getCtx().lineTo(x + borderRadius, y + h);\n  }\n\n  leftBorder({ x, y, borderRadius, w, h }) {\n    // 左下角\n    borderRadius &&\n      this.getCtx().arc(\n        x + borderRadius,\n        y + h - borderRadius,\n        borderRadius,\n        angle,\n        angle * 2\n      );\n    this.getCtx().lineTo(x, y + borderRadius);\n  }\n\n  _drawBox(element) {\n    if (!(element.renderStyles.borderColor || element.renderStyles.shadowBlur))\n      return;\n    const {\n      contentWidth,\n      contentHeight,\n      paddingLeft,\n      paddingTop,\n      borderStyle,\n      paddingRight,\n      paddingBottom,\n      borderLeftWidth,\n      borderRightWidth,\n      borderTopWidth,\n      borderBottomWidth,\n      borderWidth,\n    } = element.renderStyles;\n\n    let borderRadius = getBorderRadius(element);\n\n    // 这里是计算画border的位置，起点位置是在线条中间，所以要考虑线条宽度\n    let x =\n      element.contentX - element.renderStyles.paddingLeft - borderLeftWidth / 2;\n    let y =\n      element.contentY - element.renderStyles.paddingTop - borderTopWidth / 2;\n    let w =\n      contentWidth +\n      paddingLeft +\n      paddingRight +\n      (borderLeftWidth + borderRightWidth) / 2;\n    let h =\n      contentHeight +\n      paddingTop +\n      paddingBottom +\n      (borderTopWidth + borderBottomWidth) / 2;\n\n    this.getCtx().lineCap = element.renderStyles.lineCap;\n    this.getCtx().strokeStyle = element.renderStyles.borderColor;\n    this.getCtx().lineJoin = \"round\";\n\n    // 实现虚线\n    if (borderStyle && borderStyle !== \"solid\") {\n      if (Array.isArray(borderStyle)) {\n        this.getCtx().setLineDash(borderStyle);\n      } else {\n        this.getCtx().setLineDash([5, 5]);\n      }\n    }\n\n    const stroke = (borderWidth) => {\n      // 有样式则绘制出来\n      this.getCtx().lineWidth = borderWidth;\n      this.getCtx().stroke();\n    };\n    this._restore(() => {\n      this._path(() => {\n        if (element.renderStyles.borderTopWidth) {\n          this.topBorder({\n            x,\n            y,\n            borderRadius: borderRadius\n              ? borderRadius + element.renderStyles.borderTopWidth / 2\n              : 0,\n            w,\n            h,\n          });\n          // 判断borderwidth 如果都是一样宽，只需要最后一次性绘制，提高性能\n          !borderWidth && stroke(element.renderStyles.borderTopWidth);\n        }\n        if (element.renderStyles.borderRightWidth) {\n          this.getCtx().moveTo(\n            x +\n              w -\n              borderRadius -\n              (borderRadius ? element.renderStyles.borderTopWidth / 2 : 0),\n            y\n          );\n          this.rightBorder({\n            x,\n            y,\n            borderRadius: borderRadius\n              ? borderRadius + element.renderStyles.borderRightWidth / 2\n              : 0,\n            w,\n            h,\n          });\n          !borderWidth && stroke(element.renderStyles.borderRightWidth);\n        }\n        if (element.renderStyles.borderBottomWidth) {\n          this.getCtx().moveTo(\n            x + w,\n            y +\n              h -\n              borderRadius -\n              (borderRadius ? element.renderStyles.borderRightWidth / 2 : 0)\n          );\n          this.bottomBorder({\n            x,\n            y,\n            borderRadius: borderRadius\n              ? borderRadius + element.renderStyles.borderBottomWidth / 2\n              : 0,\n            w,\n            h,\n          });\n          !borderWidth && stroke(element.renderStyles.borderBottomWidth);\n        }\n        if (element.renderStyles.borderLeftWidth) {\n          this.getCtx().moveTo(\n            x +\n              borderRadius +\n              (borderRadius ? element.renderStyles.borderBottomWidth / 2 : 0),\n            y + h\n          );\n          this.leftBorder({\n            x,\n            y,\n            borderRadius: borderRadius\n              ? borderRadius + element.renderStyles.borderLeftWidth / 2\n              : 0,\n            w,\n            h,\n          });\n          stroke(element.renderStyles.borderLeftWidth);\n        }\n      });\n    });\n  }\n\n  _drawBackground(element) {\n    const {\n      backgroundColor,\n      contentWidth,\n      contentHeight,\n      shadowColor,\n      shadowBlur,\n      paddingLeft,\n      paddingRight,\n      paddingTop,\n      paddingBottom,\n      opacity,\n      shadowOffsetX,\n      shadowOffsetY,\n      borderLeftWidth,\n      borderRightWidth,\n      borderTopWidth,\n      borderBottomWidth,\n    } = element.renderStyles;\n    const ctx = this.getCtx();\n\n    let borderRadius = getBorderRadius(element);\n\n    // 这里是计算画border的位置，起点位置是在线条中间，所以要考虑线条宽度\n    let x =\n      element.contentX - element.renderStyles.paddingLeft - borderLeftWidth;\n    let y = element.contentY - element.renderStyles.paddingTop - borderTopWidth;\n    let w =\n      contentWidth +\n      paddingLeft +\n      paddingRight +\n      (borderLeftWidth + borderRightWidth);\n    let h =\n      contentHeight +\n      paddingTop +\n      paddingBottom +\n      (borderTopWidth + borderBottomWidth);\n\n    if (isExact(opacity)) {\n      // 绘制透明图\n      ctx.globalAlpha = opacity;\n    }\n\n    // 绘制boxshadow\n    // 需要在clip之前\n    if (shadowColor && shadowBlur) {\n      this._restore(() => {\n        this._path(() => {\n          this.topBorder({ x, y, borderRadius, w, h });\n          this.rightBorder({ x, y, borderRadius, w, h });\n          this.bottomBorder({ x, y, borderRadius, w, h });\n          this.leftBorder({ x, y, borderRadius, w, h });\n        });\n        if (isExact(shadowOffsetX)) {\n          this.getCtx().shadowOffsetX = shadowOffsetX;\n        }\n        if (isExact(shadowOffsetY)) {\n          this.getCtx().shadowOffsetY = shadowOffsetY;\n        }\n        this.getCtx().shadowBlur = shadowBlur;\n        this.getCtx().shadowColor = shadowColor;\n        this.getCtx().fillStyle = shadowColor;\n        this.getCtx().fill();\n      });\n    }\n\n    this._clip(element);\n\n    // draw background\n    if (backgroundColor) {\n      this.getCtx().fillStyle = this._parseBackground(backgroundColor, element);\n      this.getCtx().fillRect(\n        element.contentX - paddingLeft,\n        element.contentY - paddingTop,\n        contentWidth + paddingLeft + paddingRight,\n        contentHeight + paddingTop + paddingBottom\n      );\n    }\n\n    // for debug\n    if (this.isDebug()) {\n      this.getCtx().strokeStyle = element.debugColor || \"green\";\n      this.getCtx().strokeRect(\n        element.contentX,\n        element.contentY,\n        element.renderStyles.contentWidth,\n        element.renderStyles.contentHeight\n      );\n      // ctx.strokeStyle = '#fff'\n      // ctx.strokeText(`${parseInt(this.contentX)} ${parseInt(this.contentY)} ${contentWidth} ${contentHeight}`, this.contentX + 100, this.contentY + 10)\n\n      //\n    }\n  }\n\n  _clip(element) {\n    if (element.renderStyles.overflow !== \"hidden\") return;\n    const {\n      contentWidth,\n      contentHeight,\n      paddingLeft,\n      paddingTop,\n      paddingRight,\n      paddingBottom,\n      borderLeftWidth,\n      borderRightWidth,\n      borderTopWidth,\n      borderBottomWidth,\n    } = element.renderStyles;\n\n    let borderRadius = getBorderRadius(element);\n\n    const borderBase = 0.7;\n    // 为了把border也切进去\n    let x =\n      element.contentX -\n      element.renderStyles.paddingLeft -\n      borderLeftWidth * borderBase;\n    let y =\n      element.contentY -\n      element.renderStyles.paddingTop -\n      borderTopWidth * borderBase;\n    let w =\n      contentWidth +\n      paddingLeft +\n      paddingRight +\n      (borderLeftWidth + borderRightWidth) * borderBase;\n    let h =\n      contentHeight +\n      paddingTop +\n      paddingBottom +\n      (borderTopWidth + borderBottomWidth) * borderBase;\n\n    this._path(() => {\n      this.topBorder({ x, y, borderRadius, w, h });\n      this.rightBorder({ x, y, borderRadius, w, h });\n      this.bottomBorder({ x, y, borderRadius, w, h });\n      this.leftBorder({ x, y, borderRadius, w, h });\n    });\n\n    this.getCtx().clip();\n  }\n\n  _parseBackground(color, element) {\n    if (Array.isArray(color)) {\n      const gradient = this.getCtx().createLinearGradient(\n        element.contentX,\n        element.contentY,\n        element.contentX + element.renderStyles.contentWidth,\n        element.contentY + element.renderStyles.contentHeight\n      );\n      for (let i = 0; i < color.length; i++) {\n        if (i === 0) {\n          gradient.addColorStop(0, color[0]);\n        } else {\n          gradient.addColorStop(i / (color.length - 1), color[i]);\n        }\n      }\n      return gradient;\n    } else {\n      return color;\n    }\n  }\n\n  _drawText(element) {\n    const {\n      color,\n      contentWidth,\n      lineHeight,\n      textAlign,\n      textIndent,\n      textDecoration,\n    } = element.renderStyles;\n    let x = element.contentX;\n    this.getCtx().fillStyle = color;\n    this.getCtx().textAlign = textAlign;\n    this.getCtx().font = element._getFont();\n    this.getCtx().textBaseline = \"middle\";\n    if (textAlign === STYLES.TEXT_ALIGN.RIGHT) {\n      x = element.contentX + contentWidth;\n    } else if (textAlign === STYLES.TEXT_ALIGN.CENTER) {\n      x = element.contentX + contentWidth / 2;\n    }\n    let _x = x;\n    let _y = 0;\n    let line;\n    for (let index = 0; index < element._lines.length; index++) {\n      line = element._lines[index];\n      if (index === 0 && textIndent) {\n        // 第一行实现textIndent\n        _x = x + textIndent;\n      } else {\n        _x = x;\n      }\n      _y = element.contentY + lineHeight / 2 + lineHeight * index + 0.5;\n\n      this.getCtx().fillText(line.text, _x, _y);\n\n      if (isWX && element.renderStyles.fontWeight !== 400) {\n        // 小程序 字体加粗不生效\n        const offset = element.renderStyles.fontSize * 0.001;\n        this.getCtx().fillText(line.text, _x - offset, _y);\n      }\n\n      // draw decoration\n      if (textDecoration) {\n        const decorationType = textDecoration[0];\n        _y += 1;\n        this._restore(() => {\n          this._path(() => {\n            let decorationY = _y;\n            if (decorationType === \"underline\") {\n              decorationY = _y + element._layout.fontHeight / 2;\n            } else if (decorationType === \"line-through\") {\n              decorationY = _y;\n            }\n            this.getCtx().moveTo(_x, decorationY);\n            this.getCtx().lineTo(_x + line.layout.width, decorationY);\n          });\n          this.getCtx().strokeStyle = color;\n          this.getCtx().stroke();\n        });\n      }\n    }\n  }\n\n  /**\n   * @param {String} text\n   * @return {Object<width,height>}\n   */\n  measureText(element, text) {\n    let w = 0;\n    let h = 0;\n    this._restore(() => {\n      this.getCtx().font = element._getFont();\n      const { width, actualBoundingBoxAscent } =\n        this.getCtx().measureText(text);\n      w = width;\n      h = actualBoundingBoxAscent || element.renderStyles.fontSize * 0.7;\n    });\n    return {\n      width: w,\n      fontHeight: h + 1,\n    };\n  }\n\n  _drawImage(element) {\n    if (!element._image) return;\n    const { contentWidth, contentHeight } = element.renderStyles;\n    const { mode } = element.options.attrs;\n    const {\n      sx,\n      sy,\n      swidth,\n      sheight,\n      dx,\n      dy,\n      dwidth,\n      dheight,\n      width: imageW,\n      height: imageH,\n    } = element._imageInfo;\n    if (mode === \"aspectFill\") {\n      this.getCtx().drawImage(\n        element._image,\n        sx,\n        sy,\n        swidth,\n        sheight,\n        element.contentX,\n        element.contentY,\n        contentWidth,\n        contentHeight\n      );\n    } else if (mode === \"aspectFit\") {\n      this.getCtx().drawImage(\n        element._image,\n        0,\n        0,\n        imageW,\n        imageH,\n        dx,\n        dy,\n        dwidth,\n        dheight\n      );\n    } else {\n      this.getCtx().drawImage(\n        element._image,\n        element.contentX,\n        element.contentY,\n        contentWidth,\n        contentHeight\n      );\n    }\n  }\n\n  _drawScroll(element) {\n    this.getCtx().translate(element.currentScrollX, element.currentScrollY);\n  }\n\n  /**\n   * 这里应该保证onload src等接口\n   */\n  getImageInstance(src) {\n    let image = null;\n\n    // 同样的路径返回缓存\n    if (this.imageBus[src]) {\n      image = this.imageBus[src];\n    } else {\n      if (isWX) {\n        if (this.getCanvas()) {\n          image = this.getCanvas().createImage();\n        } else {\n          console.warn(\"小程序请使用设置canvas参数以创建图片\");\n          image = getImage(src);\n        }\n      } else {\n        image = new Image();\n        image.crossOrigin = 'anonymous';\n      }\n\n      if (src) {\n        this.imageBus[src] = new Promise((resolve, reject) => {\n          image.onload = (e) => {\n            resolve({\n              image: isWX && !this.getCanvas() ? e.image : image,\n              info: {\n                width: isWX ? image.width : e.target.width,\n                height: isWX ? image.height : e.target.height,\n              },\n            });\n          };\n          image.onerror = (err) => {\n            reject(err);\n          };\n        });\n      }\n\n      image.src = src;\n    }\n    return this.imageBus[src];\n  }\n\n  render(node) {\n    this.lastFrameComplete = false;\n    this.lastPaintTime = Date.now();\n    if (!node.parent) {\n      // root\n      this.getCtx().clearRect(\n        0,\n        0,\n        this.getLayer().options.width,\n        this.getLayer().options.height\n      );\n    } else {\n      this.getCtx().clearRect(\n        node.x,\n        node.y,\n        node.renderStyles.width,\n        node.renderStyles.height\n      );\n    }\n    let element = null;\n    walk(node, (renderNode, callContinue, callNext) => {\n      if (renderNode.isVisible()) {\n        // 可见的才渲染\n        this.paint(renderNode);\n      } else {\n        // 跳过整个子节点\n        callNext();\n        this._helpParentRestoreCtx(renderNode);\n      }\n    });\n    if (isWX) {\n      // 兼容小程序\n      this.getCtx().draw && this.getCtx().draw();\n    }\n\n    this.lastFrameComplete = true;\n  }\n\n  renderFPS() {}\n\n  readyToRender(element) {\n    // this.element = generateRenderTree(element)\n    this.element = element;\n\n    const options = this.getLayer().options;\n\n    this.lastPaintTime = Date.now();\n\n    if (options && options.animate) {\n      this.animate();\n    } else {\n      this.render(this.element);\n    }\n  }\n\n  requestRepaint(element) {\n    if (this.isAnimate) return;\n    // 如果已经有frame在排队等待了 忽略\n    // if(!this.lastFrameComplete) return\n    // let nextFrameTime = Date.now() - this.lastPaintTime\n    // if(nextFrameTime < 16){\n    //   setTimeout(() => this.render(this.element),nextFrameTime)\n    // }else{\n    this.render(this.element);\n    // }\n  }\n\n  // could be null\n  getCanvas() {\n    const options = this.getLayer().options;\n    return (options && options.canvas) || null;\n  }\n\n  _animate(preTime) {\n    const now = Date.now();\n    this.render(this.element);\n    if (!this.isAnimate) return;\n    window.requestAnimationFrame(() => this._animate(now));\n  }\n\n  /**\n   * 不建议使用了\n   */\n  animate() {\n    this.isAnimate = true;\n    window.requestAnimationFrame(() => this._animate());\n  }\n\n  stopAnimate() {\n    this.isAnimate = false;\n  }\n\n  // 所有副作用完成\n  // 图片加载异步请求\n  onEffectFinished() {\n    const list = Object.keys(this.imageBus).map((key) => {\n      return this.imageBus[key];\n    });\n    return Promise.all(list);\n  }\n}\n\nfunction getBorderRadius(element) {\n  const { paddingWidth, paddingHeight } = element.renderStyles;\n  let { borderRadius } = element.renderStyles;\n  if (borderRadius * 2 > paddingWidth) {\n    // 如果大于一半，则角不是90度，统一限制最大为一半\n    borderRadius = paddingWidth / 2;\n  }\n  if (borderRadius * 2 > paddingHeight) {\n    borderRadius = paddingHeight / 2;\n  }\n  if (borderRadius < 0) borderRadius = 0;\n  return floor(borderRadius);\n}\n\n// function generateRenderTree(element){\n//   const _root = new RenderNode(element)\n//   let preZ = 0\n//   let pivotZ = 0\n//   let cur = null\n//   let stack = [_root]\n//   while(stack.length){\n//     cur = stack.pop()\n//     if(cur.element.hasChildren()){\n//       cur.children = cur.element._getChildren().map(item => new RenderNode(item))\n//       // sort by zIndex\n//       cur.children = qSort3(cur.children,(pre,pivot) => {\n//         preZ = pre.element.renderStyles.zIndex || 0\n//         pivotZ = pivot.element.renderStyles.zIndex || 0\n//         return preZ - pivotZ\n//       })\n//       Array.prototype.push.apply(stack,cur.children)\n//     }\n//   }\n//   TreeNode.connectChildren(_root)\n//   return _root\n// }\n\n// class RenderNode extends TreeNode {\n//   constructor(element){\n//     super()\n//     this.element = element\n//   }\n// }\n","import { isWX } from \"./utils\"\n\n// 只支持小程序最新的支持同层渲染的canvas api,\n// 不用了\nexport function getImage(url) {\n  const instance = {onload: () => {}}\n  new Promise((resolve, reject) => {\n    wx.downloadFile({\n      url:url,\n      success(res) {\n        wx.getImageInfo({\n          src: res.tempFilePath,\n          success(res1) {\n            resolve({\n              target: {\n                width: res1.width,\n                height: res1.height\n              },\n              image: res.tempFilePath\n            })\n          }\n        })\n      },\n      fail(err) {\n        reject(err)\n      }\n    })\n  })\n  .then((res) => {\n    instance.onload(res)\n  })\n  .catch(err => {\n\n  })\n  return instance\n}\n\n","import EventManager from './event-manager'\nimport { walk, breadthFirstSearch, breadthFirstSearchRight, walkParent, isWX } from './utils'\nimport TreeNode from './tree-node'\nimport CanvasRender from './canvas-render'\nexport default class Layer {\n  constructor(ctx, options) {\n    this.ctx = ctx\n    this.node = null\n    this.isAnimate = false\n    this.nodeList = []\n    this.p2cList = []\n    this.c2pList = []\n    this.renderList = []\n    this.options = options\n    this.eventManager = new EventManager(options)\n    this.render = new CanvasRender(this)\n  }\n\n  update(ctx, options) {\n    this.ctx = ctx\n    this.options = options\n    this.options.renderStyles = options\n    this.node.container = this.options\n  }\n\n  mountNode(node) {\n    this.node = node\n    this.node.root = this.node\n    this.node.layer = this\n    this.node.container = this.options\n    // 事件也清空一下，重新挂载\n    this.eventManager.clear()\n    this.initRender()\n  }\n\n  initRender() {\n    // for 打印耗时\n    const startTime = Date.now()\n\n    TreeNode.connectChildren(this.node)\n    this.initP2CList()\n    this.initC2PList()\n\n    this.flow()\n\n    // flow 完成后监听effect完成\n    this.render.onEffectFinished()\n      .then((res) => this.lifecycle('onEffectSuccess', res))\n      .catch((res) => this.lifecycle('onEffectFail', res))\n    // .finally((res) => this.lifecycle('onEffectFinished', res))\n\n    this.repaint()\n\n    console.log(`渲染${this.p2cList.length}个元素 耗时 ${(Date.now() - startTime)} ms`)\n  }\n\n  initP2CList() {\n    // 广度优先\n    this.p2cList = breadthFirstSearch(this.node)\n  }\n\n  initC2PList() {\n    this.c2pList = breadthFirstSearchRight(this.node)\n  }\n\n\n  flow(node = this.node) {\n    for (let i = 0; i < this.p2cList.length; i++) {\n      this.p2cList[i].init()\n    }\n\n    this.reflow()\n  }\n\n  initPaintList() {\n    // 这里实现index\n    this.renderList = this.nodeList\n  }\n\n  reflow(node = this.node) {\n\n    for (let i = 0; i < this.c2pList.length; i++) {\n      this.c2pList[i]._initWidthHeight()\n    }\n\n    for (let i = 0; i < this.p2cList.length; i++) {\n      this.p2cList[i]._initPosition()\n    }\n  }\n\n  reflowElement(element) {\n    // 如果有line，则需要重第一个开始\n    let target = element\n    while (target && target.line) {\n      target = target.parent\n    }\n    const p2cList = breadthFirstSearch(target)\n    for (let i = 0; i < p2cList.length; i++) {\n      p2cList[i]._initStyles()\n    }\n\n    // 所有子元素\n    const children = breadthFirstSearchRight(target)\n    for (let i = 0; i < children.length; i++) {\n      children[i]._initWidthHeight()\n    }\n\n    if (!element.isInFlow()) {\n      for (let i = 0; i < p2cList.length; i++) {\n        p2cList[i]._initPosition()\n      }\n      this.repaint()\n    } else {\n      this.onElementChange(target)\n    }\n\n\n  }\n\n  onElementRemove(element) {\n    this.eventManager.removeElement(element)\n    this.initC2PList()\n    this.initP2CList()\n    this.reflowElement(element)\n  }\n\n  onElementAdd(element) {\n    TreeNode.connectChildren(element)\n    this.initC2PList()\n    this.initP2CList()\n    breadthFirstSearch(element).forEach(item => item.init())\n    this.reflowElement(element)\n  }\n\n  // 元素变化后调用，尽可能少重排重绘\n  onElementChange(element) {\n\n    walkParent(element, (parent, callbreak) => {\n      parent._initWidthHeight()\n      if (parent.type === 'scroll-view') callbreak()\n    })\n\n    for (let i = 0; i < this.p2cList.length; i++) {\n      this.p2cList[i]._initPosition()\n    }\n    this.repaint()\n  }\n\n  callBeforePaint() {\n    for (let i = 0; i < this.p2cList.length; i++) {\n      this.p2cList[i].beforePaint && this.p2cList[i].beforePaint()\n    }\n  }\n\n  /**\n   * 可以给定element，则只会重绘element所在的区域\n   * @param {Element} element\n   */\n  repaint(element = this.node) {\n    if (isWX) {\n      // 微信环境下始终重绘整个树\n      element = this.node\n    }\n    if (!element.isInFlow()) element = this.node\n\n    this.callBeforePaint()\n\n    this.render.readyToRender(this.node)\n  }\n\n  animate() {\n    console.warn('use [animate] option instead!')\n  }\n\n  getElementBy() {\n    return this.node.getElementBy(...arguments)\n  }\n\n  lifecycle(name, arg) {\n    if (this.options.lifecycle) {\n      this.options.lifecycle[name] && this.options.lifecycle[name](arg)\n    }\n  }\n\n}\n\n\n","import View from './view'\nimport { easeInOutElastic, isExact, isAuto, floor } from './utils'\nimport STYLES from './constants'\n\nexport default class ScrollView extends View {\n\n  constructor(options, children) {\n    const { styles, ...rest } = options\n    super(rest, children)\n    this.options.styles = {\n      direction: styles.direction || 'y'\n    }\n    // 外面包裹一层容器，内层的滚动\n    options.styles.overflow = 'hidden'\n    this.type = 'scroll-view'\n    this._scrollView = new View(options, [this])\n    this._scrollView.type = 'scroll-view-container'\n    this.visibleIndex = null\n    this.renderOnDemand = options.attrs && options.attrs.renderOnDemand || false\n    return this._scrollView\n  }\n\n  _getDefaultStyles() {\n    return {\n      ...STYLES.DEFAULT_STYLES,\n      direction: 'y',\n    }\n  }\n\n  beforePaint() {\n    this.initChildrenVisible()\n  }\n\n  _initWidthHeight() {\n    super._initWidthHeight()\n    // 这里需要父级款高度，但是外层必须是exact\n    this.initScroll()\n  }\n\n  _paint() {\n    this.getRender()._drawBackground(this)\n    this.getRender()._drawScroll(this)\n    this.getRender()._drawBox(this)\n  }\n\n  init() {\n    super.init()\n    this.addEventListener()\n    const { height, width } = this._scrollView.styles\n    const { direction } = this.styles\n    if (direction.match('y')) {\n      if (isAuto(height)) {\n        // 必须设置\n        console.error('scroll-view 必须设置明确的高度')\n      } else {\n        this.styles.height = 'auto'\n        this.renderStyles.height = 'auto'\n      }\n    }\n    if (direction.match('x')) {\n      if (isAuto(width)) {\n        // 必须设置\n        console.error('scroll-view 必须设置明确的宽度')\n      } else {\n        this.styles.width = 'auto'\n        this.renderStyles.width = 'auto'\n      }\n    }\n  }\n\n  addEventListener() {\n    // 监听滚动\n    this.currentScrollX = 0\n    this.currentScrollY = 0\n    let direction = this.styles.direction\n    let startX = 0\n    let startY = 0\n    let lastStartX = 0\n    let lastStartY = 0\n    let startMove = false\n    let offsetX = 0\n    let offsetY = 0\n    let speedX = 0\n    let speedY = 0\n    let glideInterval = null\n    let resistanceX = 1\n    let resistanceY = 1\n\n    this.getLayer().eventManager.EVENTS.forEach(eventName => {\n      this.getLayer().eventManager.addEventListener(eventName, (e) => {\n        if (direction.match('y')) {\n          e.relativeY -= this.currentScrollY\n        }\n        if (direction.match('x')) {\n          e.relativeX -= this.currentScrollX\n        }\n      }, this._scrollView, true)\n    })\n\n    this.getLayer().eventManager.addEventListener('mousewheel', (e) => {\n      if (!this.scrollBy(e.deltaX, e.deltaY)) {\n        this.scrollTo({ x: e.deltaX <= 0 ? this.maxScrollX : 0, y: e.deltaY <= 0 ? this.maxScrollY : 0 })\n      } else {\n        e.stopPropagation()\n      }\n    }, this._scrollView)\n\n    this.getLayer().eventManager.addEventListener('touchstart', (e) => {\n      e.stopPropagation()\n      startX = e.x\n      startY = e.y\n      lastStartX = startX\n      lastStartY = startY\n      startMove = true\n      clearInterval(glideInterval)\n    }, this._scrollView)\n    this.getLayer().eventManager.addEventListener('touchmove', (e) => {\n      if (startMove) {\n        e.stopPropagation()\n        offsetX = (e.x - startX)\n        offsetY = (e.y - startY)\n        if (this.scrollBy(offsetX, offsetY)) {\n          lastStartX = startX\n          lastStartY = startY\n          startX = e.x\n          startY = e.y\n        }\n      }\n    }, this._scrollView)\n    this.getLayer().eventManager.addEventListener('touchend', (e) => {\n      if (startMove) {\n        startMove = false\n\n        speedX = (e.x - lastStartX)\n        speedY = (e.y - lastStartY)\n        resistanceX = -speedX * 0.02\n        resistanceY = -speedY * 0.02\n        clearInterval(glideInterval)\n        glideInterval = setInterval(() => {\n          if (!this.scrollBy(speedX, speedY)) {\n            this.scrollTo(this.currentScrollX + speedX, this.currentScrollY + speedY)\n            clearInterval(glideInterval)\n          }\n          speedX += resistanceX\n          speedY += resistanceY\n          if (speedX * speedX <= 0.05 && speedY * speedY <= 0.05) {\n            speedX = 0\n            speedY = 0\n            clearInterval(glideInterval)\n          }\n        }, 16)\n      }\n    }, this._scrollView)\n  }\n\n  initScroll() {\n    const { contentWidth: offsetWidth, contentHeight: offsetHeight } = this._scrollView.renderStyles\n    const { width: scrollWidth, height: scrollHeight, direction } = this.renderStyles\n    this.maxScrollX = scrollWidth - offsetWidth\n    this.maxScrollY = scrollHeight - offsetHeight\n  }\n\n  calcScrollBoundX(offsetX) {\n    if ((- this.currentScrollX - offsetX) > this.maxScrollX) {\n      return false\n    } else if (this.currentScrollX + offsetX > 0) {\n      return false\n    }\n\n    return true\n  }\n\n  calcScrollBoundY(offsetY) {\n    if ((- this.currentScrollY - offsetY) > this.maxScrollY) {\n      return false\n    } else if (this.currentScrollY + offsetY > 0) {\n      return false\n    }\n\n    return true\n  }\n\n  scrollByX(offsetX) {\n    if (!this.renderStyles.direction.match('x')) return false\n    if (this.calcScrollBoundX(offsetX)) {\n      this.currentScrollX += offsetX\n      return true\n    } else {\n      return false\n    }\n  }\n\n  scrollByY(offsetY) {\n    if (!this.renderStyles.direction.match('y')) return false\n    if (this.calcScrollBoundY(offsetY)) {\n      this.currentScrollY += floor(offsetY)\n      this.calcChildrenVisible()\n      // this.getLayer().repaint(this._scrollView)\n      return true\n    } else {\n      return false\n    }\n  }\n\n  scrollBy(offsetX, offsetY) {\n    // 这里要两个都运行，所以不要用短路\n    if (this.scrollByX(offsetX) | this.scrollByY(offsetY)) {\n      this.getRender().requestRepaint(this._scrollView)\n      return true\n    }\n    return false\n  }\n\n  scrollTo({ x, y }) {\n    if (isExact(x) && this.maxScrollX > 0) {\n      x = x\n      if (x > this.maxScrollX) x = this.maxScrollX\n      this.currentScrollX = -floor(x)\n    }\n    if (isExact(y) && this.maxScrollY > 0) {\n      y = y\n      if (y > this.maxScrollY) y = this.maxScrollY\n      this.currentScrollY = -floor(y)\n    }\n    this.initChildrenVisible()\n    this.getRender().requestRepaint(this._scrollView)\n  }\n\n  // TODO:\n  initChildrenVisible() {\n    if (!this.renderOnDemand) return\n\n    // console.log('==============')\n    const children = this._getChildrenInFlow()\n    // 左\n    for (let i = 0; i < children.length; i++) {\n      if (this.isElementInViewport(children[i])) {\n        this.visibleIndex = [i, -1]\n        break\n      } else {\n        children[i].visible = false\n      }\n    }\n\n    // 右\n    for (let i = children.length - 1; i >= 0; i--) {\n      if (this.isElementInViewport(children[i])) {\n        this.visibleIndex[1] = i\n        break\n      } else {\n        children[i].visible = false\n      }\n    }\n\n    // 中间\n    for (let i = this.visibleIndex[0]; i <= this.visibleIndex[1]; i++) {\n      children[i].visible = true\n    }\n  }\n\n  // 只用计算两头\n  // 数据量时能显著提高效率\n  // 滚动太快会有问题，暂时使用上面的init\n  calcChildrenVisible() {\n    if (!this.renderOnDemand) return\n    const children = this._getChildrenInFlow()\n    const head = generateSiblingNodeIndex(this.visibleIndex[0], 5)\n    const foot = generateSiblingNodeIndex(this.visibleIndex[1], 5)\n    let visibleIndex = []\n    for (let i = head[0]; i <= head[head.length - 1]; i++) {\n      if (children[i]) {\n        if (this.isElementInViewport(children[i])) {\n          children[i].visible = true\n          if (!visibleIndex.length) {\n            visibleIndex.push(i)\n          }\n        } else {\n          children[i].visible = false\n        }\n      }\n    }\n    for (let i = foot[foot.length - 1]; i >= foot[0]; i--) {\n      if (children[i]) {\n        if (this.isElementInViewport(children[i])) {\n          children[i].visible = true\n          if (visibleIndex.length === 1) {\n            visibleIndex.push(i)\n          }\n        } else {\n          children[i].visible = false\n        }\n      }\n    }\n    this.visibleIndex = visibleIndex\n    if (this.visibleIndex.length < 2) {\n      this.initChildrenVisible()\n    }\n  }\n\n  isElementInViewport(element) {\n    if (this.styles.direction.match('y')) {\n      return ((element.y + element.renderStyles.height + this.currentScrollY) > this._scrollView.contentY)\n        && ((element.y + this.currentScrollY) < this._scrollView.contentY + this._scrollView.renderStyles.contentHeight)\n    } else {\n      return true\n      // return ((element.x + element.renderStyles.width + this.currentScroll) > this._scrollView.contentX)\n      // && ((element.x + this.currentScroll) < this._scrollView.contentX + this._scrollView.renderStyles.contentWidth)\n    }\n  }\n\n}\n\n\nfunction generateSiblingNodeIndex(index, offset) {\n  let start = index - offset\n  let end = index + offset\n  let list = []\n  for (let i = start; i <= end; i++) {\n    list.push(i)\n  }\n  return list\n}\n","import View from './view'\nimport Text from './text'\nimport Image from './image'\nimport Layer from './layer'\nimport ScrollView from './scroll-view'\n\n/**\n * 生成一个element tree\n * @param {String} name\n * @param {Function} options\n */\n\nconst elementFactory = {}\n//\nregisterComponent('view', (options, children) => new View(options, children))\nregisterComponent('text', (options, children) => new Text(options, children))\nregisterComponent('image', (options, children) => new Image(options, children))\nregisterComponent('scroll-view', (options, children) => new ScrollView(options, children))\nregisterComponent('scrollview', (options, children) => new ScrollView(options, children))\n\nexport function createElement(model) {\n  // 生成树\n  function c(name, options = {}, children = []) {\n    // if (arguments.length < 3) {\n    //   throw Error(`Element [${name}]: need 3 argument but get 2`)\n    // }\n    let _element = null\n    let _children = children\n    if (elementFactory[name]) {\n      if (typeof children === 'string' && name !== 'text') {\n        // 支持text简写\n        _children = [new Text({}, children)]\n      } else if (!Array.isArray(children) && name !== 'text') {\n        throw Error(`Element [${name}]:Children must be type of Array!`)\n      }\n      _element = elementFactory[name](options, _children, c)\n    } else {\n      throw Error(`Unknown tag name [${name}] !`)\n    }\n    return _element\n  }\n  const _model = model(c)\n  // 挂载children\n  return _model\n}\n\nexport function createLayer(ctx, options) {\n  return new Layer(ctx, options)\n}\n\n// 注册全局组件\nexport function registerComponent(name, factory) {\n  if (elementFactory[name]) {\n    throw Error(`Already exist tag name [${name}] !`)\n  }\n  elementFactory[name] = factory\n}\n\n\n\n\n\n","\nimport { createElement, createLayer, registerComponent } from './create-element'\nimport px from './px'\nimport './weapp-adapter'\nimport View from './view'\nimport Text from './text'\nimport Image from './image'\nimport Layer from './layer'\nimport ScrollView from './scroll-view'\nimport { mergeOptions } from './utils'\n\n\nconst ef = {\n  createLayer,\n  createElement,\n  component: registerComponent,\n  View,\n  Text,\n  Image,\n  Layer,\n  ScrollView,\n  mergeOptions\n}\n\n\n\nexport default ef\n\n"],"names":["DISPLAY","BLOCK","INLINE_BLOCK","INLINE","FLEX","NONE","WIDTH","AUTO","OUTER","FLEX_DIRECTION","ROW","COLUMN","POSITION","ABSOLUTE","FIXED","RELATIVE","STATIC","DEFAULT_STYLES","display","fontSize","fontWeight","fontFamily","color","paddingTop","paddingBottom","paddingLeft","paddingRight","marginTop","marginBottom","marginLeft","marginRight","height","borderRadius","lineCap","flexDirection","verticalAlign","textAlign","justifyContent","alignItems","whiteSpace","zIndex","visible","position","TEXT_ALIGN","LEFT","RIGHT","CENTER","isExact","num","isAuto","isOuter","match","parseOuter","_n","parseInt","replace","isNaN","walk","element","callback","_continue","_next","_callContinue","_callNext","stack","item","children","push","length","pop","_getChildren","i","walkParent","cur","stop","callbreak","parent","isWX","Boolean","wx","getSystemInfoSync","err","breadthFirstSearch","node","nodes","queue","unshift","shift","_generateRender","breadthFirstSearchRight","reverse","mergeKeys","floor","val","Line","[object Object]","this","width","contentWidth","y","doorClosed","outerWidth","container","elements","start","end","offsetX","id","Math","random","el","initHeight","styles","Infinity","renderStyles","add","lineHeight","right","_getContainerLayout","contentX","x","getPreLine","initLayout","getOffsetY","line","refreshWidthHeight","next","closeLine","refreshXAlign","pre","_getPreLayout","contentY","KEY","STYLES","contentHeight","FlexBox","super","exactValue","flexTotal","key","calcFlex","flex","containerWidth","forEach","child","_refreshContentWithLayout","alignSelf","TreeNode","hasChildren","filter","map","index","_setParent","_setSibling","connectChildren","root","Array","isArray","treeNode","Error","indexOf","splice","removeChild","_completeFlex","isInFlow","_completeWidth","borderWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","borderTopWidth","overflow","_completeBorder","_completeFont","padding","margin","_completePaddingMargin","Element","options","Object","assign","attrs","on","render","_initStyles","initEvent","keys","eventName","getLayer","eventManager","EVENTS","includes","addEventListener","removeElement","layer","mountNode","_getDefaultStyles","_getParentStyles","_completeStyles","_initRenderStyles","parentWidth","parentHeight","paddingWidth","paddingHeight","_getTotalBorderWidth","_getTotalBorderHeight","_InFlexBox","_bindFlexBox","relativeTo","findRelativeTo","curStyles","extendStyles","completeStyles","ctx","layout","_measureLayout","_refreshLayoutWithContent","_bindLine","refreshElementPosition","top","bottom","left","canIEnter","bind","_getChildrenInFlow","value","appendChild","onElementAdd","prependChild","onElementRemove","append","prepend","_needReflow","reflowElement","getRender","requestRepaint","View","type","getCtx","getCanvas","_drawBackground","_drawBox","Text","_layout","_lines","debugColor","_drawText","measureText","_calcLine","textWidth","textHeight","parentContentWidth","text","lineIndex","lineText","lastLayout","maxLine","substring","undefined","$Image","_imageInfo","sx","sy","swidth","sheight","dx","dy","dwidth","dheight","_image","init","timeout","setTimeout","_loadImage","_drawImage","mode","Promise","resolve","reject","getImageInstance","src","then","info","image","_layoutImage","isVisible","load","catch","error","imageW","imageH","w","h","getHeightByWidth","getWidthByHeight","originWidth","originHeight","events","EventManager","simulateClick","clear","touchStartEvent","event","Event","_emit","checkClick","deltaX","deltaY","e","tree","callbackList","curArr","walkArray","callBreak","isEnd","isPointInElement","relativeX","relativeY","runCapture","currentTarget","runCallback","cancelBubble","a1","a2","a3","a4","remove","isCapture","list","console","addCallback","target","p","Callback","addCapture","startx","starty","endx","endy","distance","click","captureList","params","call","arr","_break","angle","PI","CanvasRender","imageBus","isAnimate","lastPaintTime","lastFrameComplete","throttle","threshold","timer","fn","getThrottle","debug","save","restore","beginPath","closePath","_paint","afterPaint","_helpParentRestoreCtx","moveTo","arc","lineTo","borderColor","shadowBlur","borderStyle","getBorderRadius","strokeStyle","lineJoin","setLineDash","stroke","lineWidth","_restore","_path","topBorder","rightBorder","bottomBorder","leftBorder","backgroundColor","shadowColor","opacity","shadowOffsetX","shadowOffsetY","globalAlpha","fillStyle","fill","_clip","_parseBackground","fillRect","isDebug","strokeRect","borderBase","clip","gradient","createLinearGradient","addColorStop","textIndent","textDecoration","font","_getFont","textBaseline","_x","_y","fillText","offset","decorationType","decorationY","fontHeight","actualBoundingBoxAscent","drawImage","translate","currentScrollX","currentScrollY","createImage","warn","url","instance","onload","downloadFile","res","getImageInfo","tempFilePath","res1","getImage","Image","crossOrigin","onerror","Date","now","clearRect","renderNode","callContinue","callNext","paint","draw","animate","canvas","preTime","window","requestAnimationFrame","_animate","all","Layer","nodeList","p2cList","c2pList","renderList","initRender","startTime","initP2CList","initC2PList","flow","onEffectFinished","lifecycle","repaint","log","reflow","_initWidthHeight","_initPosition","onElementChange","beforePaint","callBeforePaint","readyToRender","getElementBy","arguments","name","arg","ScrollView","rest","direction","_scrollView","visibleIndex","renderOnDemand","initChildrenVisible","initScroll","_drawScroll","startX","startY","lastStartX","lastStartY","startMove","offsetY","speedX","speedY","glideInterval","resistanceX","resistanceY","scrollBy","stopPropagation","scrollTo","maxScrollX","maxScrollY","clearInterval","setInterval","offsetWidth","offsetHeight","scrollWidth","scrollHeight","calcScrollBoundX","calcScrollBoundY","calcChildrenVisible","scrollByX","scrollByY","isElementInViewport","head","generateSiblingNodeIndex","foot","elementFactory","registerComponent","factory","createLayer","createElement","model","c","_element","_children","component","mergeOptions","mergedOptions"],"mappings":"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"}